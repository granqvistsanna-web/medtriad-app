---
phase: 21-design-system-foundation
plan: 02
type: execute
wave: 2
depends_on: ["21-01"]
files_modified:
  - medtriad/app/_layout.tsx
  - medtriad/components/primitives/Icon.tsx
  - medtriad/components/primitives/Surface.tsx
  - medtriad/components/primitives/index.ts
autonomous: true

must_haves:
  truths:
    - "App loads Figtree fonts before rendering UI"
    - "No flash of unstyled text on app launch"
    - "Icon component renders Solar Icons at three standardized sizes"
    - "Surface component provides themed backgrounds with optional shadows"
  artifacts:
    - path: "medtriad/components/primitives/Icon.tsx"
      provides: "Solar Icons wrapper with sm/md/lg sizes"
      exports: ["Icon"]
    - path: "medtriad/components/primitives/Surface.tsx"
      provides: "Themed container primitive"
      exports: ["Surface"]
    - path: "medtriad/app/_layout.tsx"
      provides: "Root layout with font loading"
      contains: "useFonts"
  key_links:
    - from: "medtriad/app/_layout.tsx"
      to: "expo-splash-screen"
      via: "SplashScreen.hideAsync"
      pattern: "SplashScreen\\.hideAsync"
    - from: "medtriad/components/primitives/Icon.tsx"
      to: "medtriad/constants/theme.ts"
      via: "theme import"
      pattern: "import.*theme.*from.*constants"
---

<objective>
Set up font loading infrastructure and create Icon and Surface primitives.

Purpose: Establish custom font rendering without FOUT (flash of unstyled text) and create the foundational primitives that Button, Badge, Tag, and Card will build upon.

Output: Working Figtree font loading, Icon primitive for Solar Icons, Surface primitive for themed containers.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/21-design-system-foundation/21-01-SUMMARY.md
@.planning/phases/21-design-system-foundation/21-RESEARCH.md
@medtriad/app/_layout.tsx
@medtriad/constants/theme.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Set up Figtree font loading in root layout</name>
  <files>medtriad/app/_layout.tsx</files>
  <action>
  Modify the root layout to load Figtree fonts and prevent FOUT:

  1. Import from @expo-google-fonts/figtree:
  ```typescript
  import {
    useFonts,
    Figtree_400Regular,
    Figtree_500Medium,
    Figtree_600SemiBold,
    Figtree_700Bold,
    Figtree_800ExtraBold,
  } from '@expo-google-fonts/figtree';
  import * as SplashScreen from 'expo-splash-screen';
  ```

  2. Call SplashScreen.preventAutoHideAsync() OUTSIDE the component (at module level):
  ```typescript
  SplashScreen.preventAutoHideAsync();
  ```

  3. In the RootLayout component:
  ```typescript
  const [fontsLoaded, fontError] = useFonts({
    'Figtree-Regular': Figtree_400Regular,
    'Figtree-Medium': Figtree_500Medium,
    'Figtree-SemiBold': Figtree_600SemiBold,
    'Figtree-Bold': Figtree_700Bold,
    'Figtree-ExtraBold': Figtree_800ExtraBold,
  });

  useEffect(() => {
    if (fontsLoaded || fontError) {
      SplashScreen.hideAsync();
    }
  }, [fontsLoaded, fontError]);

  if (!fontsLoaded && !fontError) {
    return null;
  }
  ```

  4. Keep all existing layout logic (Stack, navigation, etc.) unchanged.

  IMPORTANT: expo-splash-screen should already be installed (check package.json). If not, install it first.
  </action>
  <verify>
  - App launches without flash of system font
  - App renders with Figtree font
  - No console errors about font loading
  - `npx tsc --noEmit` passes
  </verify>
  <done>
  - Root layout loads all 5 Figtree weights
  - SplashScreen hides only after fonts are ready
  - App visually renders with custom font
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Icon and Surface primitives</name>
  <files>
    medtriad/components/primitives/Icon.tsx
    medtriad/components/primitives/Surface.tsx
    medtriad/components/primitives/index.ts
  </files>
  <action>
  Create the primitives/ directory and implement:

  **Icon.tsx:**
  Create an icon wrapper component with standardized sizes (16, 20, 24):

  ```typescript
  import { View, StyleSheet, type ViewStyle } from 'react-native';
  import { theme } from '@/constants/theme';

  type IconSize = 'sm' | 'md' | 'lg';

  const SIZES: Record<IconSize, number> = {
    sm: 16,  // Inline text, badges
    md: 20,  // Buttons
    lg: 24,  // Navigation, prominent
  };

  type IconProps = {
    name: string;
    size?: IconSize;
    color?: string;
    style?: ViewStyle;
  };

  export function Icon({ name, size = 'md', color = theme.colors.text.primary, style }: IconProps) {
    const pixelSize = SIZES[size];

    // If @solar-icons/react-native is installed, import and use it:
    // import * as SolarIcons from '@solar-icons/react-native';
    // const IconComponent = SolarIcons[name];
    // return <IconComponent size={pixelSize} color={color} style={style} />;

    // Fallback: Use a placeholder or import individual SVG icons
    // For now, create a working structure that can be populated with icons
    // Check Plan 01 summary for solar icons availability

    // If solar icons unavailable, create a simple mapping approach:
    // We'll add specific icons as needed. For now, export the size constants.

    return (
      <View style={[{ width: pixelSize, height: pixelSize }, style]}>
        {/* Icon content will be added based on available library */}
      </View>
    );
  }

  // Export size constants for direct use if needed
  export const ICON_SIZES = SIZES;
  ```

  IMPORTANT for Icon implementation:
  - Check 21-01-SUMMARY.md for whether @solar-icons/react-native was installed
  - If installed: Import and render Solar Icons dynamically by name
  - If NOT installed: Create a mapping approach using react-native-svg or individual icon components
  - Either way, the API (name, size, color) should work the same

  **Surface.tsx:**
  Create a themed container primitive:

  ```typescript
  import { View, StyleSheet, type ViewStyle, type ViewProps } from 'react-native';
  import { theme } from '@/constants/theme';

  type SurfaceVariant = 'primary' | 'secondary' | 'card' | 'brand' | 'brandSubtle';
  type SurfaceElevation = 'none' | 'sm' | 'md' | 'lg';

  type SurfaceProps = ViewProps & {
    variant?: SurfaceVariant;
    elevation?: SurfaceElevation;
    style?: ViewStyle;
    children?: React.ReactNode;
  };

  export function Surface({
    variant = 'primary',
    elevation = 'none',
    style,
    children,
    ...props
  }: SurfaceProps) {
    const backgroundColor = theme.colors.surface[variant];
    const shadow = elevation !== 'none' ? theme.shadows[elevation] : {};

    return (
      <View
        style={[
          { backgroundColor },
          shadow,
          style,
        ]}
        {...props}
      >
        {children}
      </View>
    );
  }
  ```

  **index.ts:**
  Barrel export:
  ```typescript
  export { Icon, ICON_SIZES } from './Icon';
  export { Surface } from './Surface';
  ```
  </action>
  <verify>
  - `npx tsc --noEmit` passes
  - Can import: `import { Icon, Surface } from '@/components/primitives'`
  - Surface renders with different variants (check backgroundColor)
  - Icon renders at correct pixel sizes
  </verify>
  <done>
  - Icon primitive exists with sm/md/lg sizes (16/20/24px)
  - Surface primitive exists with 5 variants and 4 elevation options
  - Both primitives use theme tokens exclusively
  - Barrel export works
  </done>
</task>

</tasks>

<verification>
- App launches with Figtree font (no system font flash)
- `ls medtriad/components/primitives/` shows Icon.tsx, Surface.tsx, index.ts
- `npx tsc --noEmit` passes
- Can render Surface with all variants
- Can render Icon at all sizes
</verification>

<success_criteria>
- DS-03 COMPLETE: Icon wrapper component using Solar Icons with standardized sizes (16, 20, 24)
- DS-05 COMPLETE: Surface primitive component using color and shadow tokens
- Figtree fonts load correctly without FOUT
</success_criteria>

<output>
After completion, create `.planning/phases/21-design-system-foundation/21-02-SUMMARY.md`
</output>
