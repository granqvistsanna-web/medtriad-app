---
phase: 21-design-system-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - medtriad/package.json
  - medtriad/constants/tokens/colors.ts
  - medtriad/constants/tokens/typography.ts
  - medtriad/constants/tokens/spacing.ts
  - medtriad/constants/tokens/radius.ts
  - medtriad/constants/tokens/shadows.ts
  - medtriad/constants/tokens/motion.ts
  - medtriad/constants/tokens/index.ts
  - medtriad/constants/theme.ts
autonomous: true

must_haves:
  truths:
    - "Raw tokens are separated from semantic tokens"
    - "All existing color values are preserved in the new structure"
    - "Theme provides semantic mappings for surface, text, brand, success, warning, danger"
    - "Required font packages are installed"
  artifacts:
    - path: "medtriad/constants/tokens/colors.ts"
      provides: "Raw color palette"
      contains: "palette"
    - path: "medtriad/constants/tokens/typography.ts"
      provides: "Typography scale definitions"
      exports: ["fontSizes", "fontWeights", "lineHeights"]
    - path: "medtriad/constants/theme.ts"
      provides: "Semantic token mapping"
      contains: "theme.colors.surface"
  key_links:
    - from: "medtriad/constants/theme.ts"
      to: "medtriad/constants/tokens/colors.ts"
      via: "import palette"
      pattern: "import.*palette.*from.*tokens/colors"
---

<objective>
Install required dependencies and restructure the existing theme.ts into a proper three-layer token system.

Purpose: Create the foundational token architecture that all primitives and components will consume. This separates raw design values from semantic meanings, enabling consistent theming.

Output: Token files in constants/tokens/, refactored theme.ts with semantic mappings, installed font and icon packages.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/21-design-system-foundation/21-RESEARCH.md
@.planning/phases/21-design-system-foundation/21-CONTEXT.md
@medtriad/constants/theme.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install font and icon dependencies</name>
  <files>medtriad/package.json</files>
  <action>
  Install the required dependencies:
  ```bash
  cd medtriad && npx expo install @expo-google-fonts/figtree
  ```

  For Solar Icons, try:
  ```bash
  npm install @solar-icons/react-native
  ```

  If @solar-icons/react-native is unavailable on npm, note this in the summary and proceed - we'll create manual SVG components in Plan 02 as fallback.

  Do NOT install anything else. Do NOT modify any code files yet.
  </action>
  <verify>
  - `npm ls @expo-google-fonts/figtree` shows package installed
  - Check if solar icons installed: `npm ls @solar-icons/react-native` (may fail if unavailable)
  </verify>
  <done>
  - Figtree font package is installed
  - Solar Icons status is known (installed or noted as unavailable)
  </done>
</task>

<task type="auto">
  <name>Task 2: Create token files and refactor theme.ts</name>
  <files>
    medtriad/constants/tokens/colors.ts
    medtriad/constants/tokens/typography.ts
    medtriad/constants/tokens/spacing.ts
    medtriad/constants/tokens/radius.ts
    medtriad/constants/tokens/shadows.ts
    medtriad/constants/tokens/motion.ts
    medtriad/constants/tokens/index.ts
    medtriad/constants/theme.ts
  </files>
  <action>
  Create the constants/tokens/ directory and split the current theme.ts into:

  **Layer 1 - Raw Tokens (constants/tokens/):**

  `colors.ts`: Extract the winePalette and organize into nested structure:
  ```typescript
  export const palette = {
    wine: {
      50: '#FCF5F8',    // primaryUltraLight
      100: '#F8E8EE',   // primaryLight
      500: '#8B2252',   // primary
      600: '#6B1A3F',   // primaryDark
      700: '#4A1230',   // primaryDarker
    },
    pink: { 100: '#FFE8EE', 200: '#FFD1DD' },
    yellow: { 100: '#FFF8E1', 500: '#F5B800', 600: '#D4A000' },
    neutral: {
      0: '#FFFFFF',
      50: '#F7F7F7',
      200: '#E5E5E5',
      300: '#CDCDCD',
      500: '#777777',
      600: '#3C3C3C',
      700: '#AFAFAF',
    },
    // ... all other colors from existing theme
  } as const;
  ```

  `typography.ts`: Font sizes, weights (as numbers), line heights. Add fontFamily names for Figtree:
  ```typescript
  export const fontFamily = {
    regular: 'Figtree-Regular',
    medium: 'Figtree-Medium',
    semibold: 'Figtree-SemiBold',
    bold: 'Figtree-Bold',
    extrabold: 'Figtree-ExtraBold',
  } as const;

  export const fontSizes = { ... } as const;
  export const fontWeights = { regular: '400', medium: '500', ... } as const;
  export const lineHeights = { ... } as const;
  ```

  `spacing.ts`: Keep existing Spacing values.

  `radius.ts`: Keep existing Radius values.

  `shadows.ts`: Keep existing shadow definitions.

  `motion.ts`: Durations and Easings from existing theme.

  `index.ts`: Barrel export all tokens.

  **Layer 2 - Semantic Theme (constants/theme.ts):**

  Refactor theme.ts to import from tokens and create semantic mapping:
  ```typescript
  import { palette } from './tokens/colors';
  import { fontFamily, fontSizes, fontWeights, lineHeights } from './tokens/typography';
  // ... other imports

  export const theme = {
    colors: {
      surface: {
        primary: palette.neutral[0],      // white
        secondary: palette.neutral[50],   // light gray
        card: palette.neutral[0],
        brand: palette.wine[100],
        brandSubtle: palette.wine[50],
      },
      text: {
        primary: palette.neutral[600],
        secondary: palette.neutral[500],
        muted: palette.neutral[700],
        inverse: palette.neutral[0],
        brand: palette.wine[700],
      },
      brand: {
        primary: palette.wine[500],
        primaryDark: palette.wine[600],
        accent: palette.pink[100],
      },
      success: {
        main: palette.success[500],
        dark: palette.success[600],
        light: palette.success[100],
        text: palette.success[700],
      },
      warning: {
        main: palette.yellow[500],
        dark: palette.yellow[600],
        light: palette.yellow[100],
      },
      danger: {
        main: palette.error[500],
        dark: palette.error[600],
        light: palette.error[100],
      },
      border: {
        default: palette.neutral[200],
        strong: palette.neutral[300],
      },
    },
    typography: { ... },  // Composed from tokens
    spacing: { ... },
    radius: { ... },
    shadows: { ... },
    motion: { ... },
  } as const;

  // Keep backward-compatible exports for gradual migration
  export { Colors, Typography, Spacing, Shadows, Radius, Durations, Easings } from './tokens';
  ```

  IMPORTANT:
  - Preserve ALL existing color values - map them to the new structure
  - Keep backward-compatible exports (Colors, Typography, etc.) so existing components don't break
  - Use `as const` for type safety
  - Include gold, streak, purple, blue colors from existing theme
  </action>
  <verify>
  - `npx tsc --noEmit` in medtriad/ has no type errors
  - Existing components still compile (Button, Card, etc.)
  - Can import: `import { theme } from '@/constants/theme'`
  - Can import: `import { palette } from '@/constants/tokens/colors'`
  </verify>
  <done>
  - Six token files exist in constants/tokens/
  - theme.ts imports from tokens and exports semantic theme object
  - Backward-compatible exports exist for existing code
  - TypeScript compiles without errors
  </done>
</task>

</tasks>

<verification>
- `npm ls @expo-google-fonts/figtree` shows installed version
- `ls medtriad/constants/tokens/` shows all 7 files (colors, typography, spacing, radius, shadows, motion, index)
- `npx tsc --noEmit` passes in medtriad/
- Existing components (Button, Card) still work
</verification>

<success_criteria>
- DS-01 COMPLETE: Token file(s) with colors, typography, spacing, radius, shadows, motion values
- DS-02 COMPLETE: Theme layer mapping semantic tokens (surface, text, brand, success, warning, danger)
- Figtree font package installed
- Solar Icons package status documented
</success_criteria>

<output>
After completion, create `.planning/phases/21-design-system-foundation/21-01-SUMMARY.md`
</output>
