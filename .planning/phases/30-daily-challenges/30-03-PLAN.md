---
phase: 30-daily-challenges
plan: 03
type: execute
wave: 3
depends_on: ["30-02"]
files_modified:
  - medtriad/components/home/DailyChallengeCard.tsx
  - medtriad/components/home/ActionButtons.tsx
  - medtriad/app/(tabs)/index.tsx
  - medtriad/hooks/useStats.ts
autonomous: false

must_haves:
  truths:
    - "Home screen shows prominent daily challenge card"
    - "Daily challenge card shows challenge type for today"
    - "Completed daily challenge shows checkmark/completed state"
    - "Tapping card navigates to daily challenge"
    - "Challenge button replaced/repurposed for daily challenge"
  artifacts:
    - path: "medtriad/components/home/DailyChallengeCard.tsx"
      provides: "Daily challenge card component for home screen"
      min_lines: 80
    - path: "medtriad/components/home/ActionButtons.tsx"
      provides: "Updated action buttons with daily challenge access"
      contains: "onDailyChallenge"
  key_links:
    - from: "medtriad/app/(tabs)/index.tsx"
      to: "medtriad/components/home/DailyChallengeCard.tsx"
      via: "component import"
      pattern: "DailyChallengeCard"
    - from: "medtriad/components/home/DailyChallengeCard.tsx"
      to: "medtriad/services/daily-challenge.ts"
      via: "state fetch"
      pattern: "getDailyChallengeState"
---

<objective>
Integrate daily challenges into the home screen with a prominent challenge card and update navigation.

Purpose: Make daily challenges discoverable and create a compelling daily habit loop entry point.
Output: Home screen with daily challenge card and updated action buttons.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/30-daily-challenges/30-01-SUMMARY.md
@.planning/phases/30-daily-challenges/30-02-SUMMARY.md

# Home screen components
@medtriad/app/(tabs)/index.tsx
@medtriad/components/home/HeroCard.tsx
@medtriad/components/home/ActionButtons.tsx
@medtriad/components/home/ReviewDueBadge.tsx

# Daily challenge service
@medtriad/services/daily-challenge.ts
@medtriad/types/daily-challenge.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create DailyChallengeCard component</name>
  <files>
    medtriad/components/home/DailyChallengeCard.tsx
  </files>
  <action>
Create `medtriad/components/home/DailyChallengeCard.tsx`:

1. **Props:**
   ```typescript
   type DailyChallengeCardProps = {
     challengeType: DailyChallengeType;
     displayName: string;
     completed: boolean;
     onPress: () => void;
     delay?: number;
   };
   ```

2. **Design (prominent, eye-catching):**
   - Full-width card below HeroCard
   - Background: gradient or brand color accent (use theme.colors.brand.primary with opacity)
   - Border: theme.colors.brand.primary border
   - Slight shadow for depth

3. **Content layout:**
   - Left side: Icon based on challenge type
     - Speed: Lightning bolt (Bolt icon)
     - Category: Book icon or category-specific icon
     - Full: Target/bullseye icon (or similar)
   - Center:
     - "DAILY CHALLENGE" label (small, uppercase)
     - Challenge type name (e.g., "Speed Round", "Cardiology Focus")
   - Right side:
     - If not completed: Chevron right arrow
     - If completed: Green checkmark with "DONE" text

4. **Completed state:**
   - Reduce opacity slightly (0.7)
   - Replace chevron with checkmark
   - Disable press (or still allow to see results)

5. **Animation:**
   - Use FadeInUp entering animation with delay prop
   - Press animation: scale down slightly on press

6. **Accessibility:**
   - accessibilityLabel: "Daily Challenge: {displayName}, {completed ? 'Completed' : 'Tap to play'}"
   - accessibilityRole: "button"
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - Component renders with correct challenge type styling
    - Completed state shows checkmark
  </verify>
  <done>DailyChallengeCard component created with type-specific styling and completion states</done>
</task>

<task type="auto">
  <name>Task 2: Update ActionButtons and home screen integration</name>
  <files>
    medtriad/components/home/ActionButtons.tsx
    medtriad/app/(tabs)/index.tsx
    medtriad/hooks/useStats.ts
  </files>
  <action>
1. **Update ActionButtons.tsx:**
   - The current "CHALLENGE" button goes to share screen
   - Rename it to "SHARE" to be clearer about its purpose
   - Keep icon as-is (or change to Share icon from solar-icons)
   - Update props: `onChallenge` -> `onShare` for clarity

   Updated buttons row:
   - STUDY (Book icon) - unchanged
   - SHARE (Share icon) - was "Challenge", goes to share screen
   - REVIEW (Refresh icon) - unchanged, with badge

2. **Update useStats.ts:**
   - Add daily challenge state to the hook return:
   ```typescript
   // Add to StatsData interface and useStats return:
   dailyChallengeState: DailyChallengeState | null;
   dailyChallengeLoading: boolean;
   refreshDailyChallenge: () => Promise<void>;
   ```
   - Fetch daily challenge state in the hook using `getDailyChallengeState()`
   - Include in refresh() function

3. **Update home screen (index.tsx):**
   - Import DailyChallengeCard
   - Get dailyChallengeState from useStats
   - Add DailyChallengeCard between HeroCard and ReviewDueBadge:
   ```tsx
   {/* Daily Challenge Card - prominent position */}
   {dailyChallengeState && (
     <DailyChallengeCard
       challengeType={dailyChallengeState.challengeConfig.type}
       displayName={dailyChallengeState.challengeConfig.displayName}
       completed={dailyChallengeState.completedToday}
       onPress={() => router.push('/daily-challenge')}
       delay={Durations.stagger * 1.5}
     />
   )}
   ```
   - Update ActionButtons props: `onChallenge` -> `onShare`
   - Adjust animation delays for smooth flow

4. **Navigation update:**
   - DailyChallengeCard onPress -> `/daily-challenge`
   - Share button (was Challenge) -> `/challenge` (share screen)
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - Home screen shows DailyChallengeCard
    - Card shows correct challenge type for today
    - Completed state shows checkmark
    - Share button navigates to share screen
  </verify>
  <done>Home screen displays daily challenge card with today's challenge type and completion state</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete daily challenge feature:
    1. Date-seeded question generation (same questions for all users each day)
    2. Three challenge variants: Speed Round (5q, 7s), Category Focus (10q, 15s), Full (10q, 15s)
    3. Daily challenge card on home screen
    4. Quiz flow with variant-specific settings
    5. Streak integration with milestone celebrations (7, 30, 100 days)
    6. Streak freeze earned after 7 daily challenges per week
    7. Once-per-day completion enforcement
  </what-built>
  <how-to-verify>
    1. Open app - see daily challenge card on home screen with today's challenge type
    2. Tap the card to start daily challenge
    3. Verify question count matches challenge type (5 for speed, 10 for others)
    4. Verify timer matches challenge type (7s for speed, 15s for others)
    5. Complete the challenge - verify results screen shows:
       - Score and correct count
       - Challenge type badge
       - Current streak
    6. Return to home - verify card now shows "DONE" with checkmark
    7. Tap card again - verify shows "Already Completed" message
    8. Test that SHARE button still works (goes to share screen)
    9. Test STUDY and REVIEW buttons still work

    **Note:** Streak milestone celebrations (7, 30, 100 days) and streak freeze earning
    require sustained usage. For now, verify the UI elements are in place.
  </how-to-verify>
  <resume-signal>Type "approved" to complete the phase, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
1. TypeScript compilation: `npx tsc --noEmit` passes
2. Home screen shows daily challenge card
3. Card displays correct challenge type for today
4. Completed daily challenge shows checkmark state
5. Quiz flow works with all three variants
6. Results show streak and record completion
7. Cannot replay daily challenge after completion
8. All existing home screen functionality preserved
</verification>

<success_criteria>
- DailyChallengeCard component created and styled
- Home screen displays daily challenge card prominently
- Card shows today's challenge type (speed/category/full)
- Completed state clearly indicated
- Navigation to daily challenge works
- Share button (formerly Challenge) still works
- Study and Review buttons unchanged
- Full daily challenge flow verified end-to-end
</success_criteria>

<output>
After completion, create `.planning/phases/30-daily-challenges/30-03-SUMMARY.md`
</output>
