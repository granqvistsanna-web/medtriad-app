---
phase: 12-levels-on-hero
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - medtriad/components/home/TierBadge.tsx
  - medtriad/components/home/TierSection.tsx
  - medtriad/components/home/HeroCard.tsx
  - medtriad/app/(tabs)/index.tsx
autonomous: true

must_haves:
  truths:
    - "User sees current tier name on Home screen hero area"
    - "User sees shield badge with tier number next to tier name"
    - "User sees progress bar showing progress to next tier"
    - "Progress bar animates from empty to current progress on appear"
    - "Tapping tier area navigates to Progress tab"
  artifacts:
    - path: "medtriad/components/home/TierBadge.tsx"
      provides: "Shield SVG badge with tier number"
      exports: ["TierBadge"]
    - path: "medtriad/components/home/TierSection.tsx"
      provides: "Tier display wrapper with badge, name, progress bar"
      exports: ["TierSection"]
    - path: "medtriad/components/home/HeroCard.tsx"
      provides: "Hero card updated to include tier section"
      contains: "TierSection"
  key_links:
    - from: "medtriad/app/(tabs)/index.tsx"
      to: "medtriad/components/home/HeroCard.tsx"
      via: "tier, tierProgress, nextTier props"
      pattern: "tier=\\{tier\\}"
    - from: "medtriad/components/home/HeroCard.tsx"
      to: "medtriad/components/home/TierSection.tsx"
      via: "component composition"
      pattern: "<TierSection"
    - from: "medtriad/components/home/TierSection.tsx"
      to: "/(tabs)/progress"
      via: "router.push on press"
      pattern: "router\\.push.*progress"
---

<objective>
Display current tier prominently on Home screen hero area with shield badge, tier name, and animated progress bar.

Purpose: Make user progression visible on the main screen, reinforcing the tier system introduced in Phase 11.
Output: TierBadge and TierSection components integrated into HeroCard, with tap-to-navigate functionality.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-levels-on-hero/12-CONTEXT.md
@.planning/phases/12-levels-on-hero/12-RESEARCH.md
@.planning/phases/11-level-system/11-01-SUMMARY.md

Key files to reference:
@medtriad/components/home/HeroCard.tsx
@medtriad/components/home/StatsGrid.tsx (AnimatedPressable pattern)
@medtriad/components/progress/TierProgressBar.tsx
@medtriad/components/home/ProgressRing.tsx (SVG pattern)
@medtriad/hooks/useStats.ts
@medtriad/services/mastery.ts (TierDefinition type)
@medtriad/constants/theme.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TierBadge component</name>
  <files>medtriad/components/home/TierBadge.tsx</files>
  <action>
Create TierBadge component using react-native-svg for shield shape with tier number inside.

Requirements:
- Shield SVG shape (simple pointed-bottom shape)
- Tier number displayed centered inside (1-6)
- Fill color: colors.primary
- Text color: colors.textInverse
- Size prop with default 32px
- Use existing SVG patterns from ProgressRing.tsx

Example shield path:
`M12 1 L22 5 L22 12 C22 18 17 22 12 24 C7 22 2 18 2 12 L2 5 Z`

SVG Text centering:
- textAnchor="middle"
- x centered in viewBox
- y adjusted for visual centering (~14 for 24-height viewBox)
- fontWeight="700" for bold tier number
  </action>
  <verify>
Import TierBadge in App.tsx or a test file, render with tierNumber={3}, visually confirm:
- Shield shape displays
- Number "3" centered inside shield
- Colors match theme (teal shield, white text)
  </verify>
  <done>TierBadge renders shield SVG with centered tier number using theme colors</done>
</task>

<task type="auto">
  <name>Task 2: Create TierSection component</name>
  <files>medtriad/components/home/TierSection.tsx</files>
  <action>
Create TierSection component that wraps tier display elements for the HeroCard.

Requirements:
- Props: tier (TierDefinition), tierProgress (number 0-1), onPress (callback)
- Layout: horizontal row with badge, tier name, then progress bar below
- Badge: Use TierBadge component
- Name: Medium prominence text (Typography.label or body), tier.name
- Progress bar: Reuse TierProgressBar from Phase 11
- Progress bar width: Match tier name section width (not full HeroCard width)
- Container: subtle styling (Claude's discretion per CONTEXT.md)
- Pressable with AnimatedPressable pattern from StatsGrid:
  - scale 0.97 on press with Easings.press spring
  - scale 1 on release
- onPress calls the provided callback

Fill animation on appear:
- TierProgressBar already animates when progress changes
- Add delay to animation start (withDelay ~300ms) so it fills AFTER the component enters
- Pass an animateOnMount prop or use a state toggle pattern:
  1. Mount with progress=0
  2. After delay, set to actual progress
  3. Bar animates from 0 to actual value

Layout structure:
```
<AnimatedPressable onPress>
  <View row>
    <TierBadge tierNumber={tier.tier} />
    <Text>{tier.name}</Text>
  </View>
  <TierProgressBar progress={displayProgress} />
</AnimatedPressable>
```

Spacing:
- Gap between badge and name: Spacing.sm
- Gap between name row and progress bar: Spacing.xs
- Padding inside pressable: Spacing.sm horizontal, Spacing.xs vertical
  </action>
  <verify>
Import TierSection in a test context, pass mock tier data:
- tier={{ tier: 2, name: 'Intern', gamesRequired: 10 }}
- tierProgress={0.5}
- onPress={() => console.log('pressed')}

Confirm:
- Badge shows "2" in shield
- "Intern" text displays next to badge
- Progress bar renders below at 50% fill
- Progress bar animates from 0 to 50% after delay
- Press animation works (scale down/up)
- onPress callback fires on tap
  </verify>
  <done>TierSection displays badge, tier name, animated progress bar with press interaction</done>
</task>

<task type="auto">
  <name>Task 3: Integrate TierSection into HeroCard and Home screen</name>
  <files>medtriad/components/home/HeroCard.tsx, medtriad/app/(tabs)/index.tsx</files>
  <action>
Update HeroCard to accept tier props and display TierSection below mascot.

HeroCard.tsx changes:
1. Add new props to HeroCardProps type:
   - tier: TierDefinition (import from @/services/mastery)
   - tierProgress: number
   - onTierPress?: () => void
2. Import TierSection component
3. Place TierSection between mascotContainer and content sections
4. Pass tier, tierProgress, onTierPress to TierSection
5. Add entry animation to TierSection container (FadeInUp.delay matching stagger)

index.tsx (Home screen) changes:
1. Destructure tier, tierProgress from useStats() (already available)
2. Remove calculateLevel import (no longer needed once masteryLevel removed)
3. Remove masteryLevel prop from HeroCard (legacy)
4. Add tier, tierProgress, onTierPress props to HeroCard:
   ```jsx
   <HeroCard
     // ...existing props
     tier={tier}
     tierProgress={tierProgress}
     onTierPress={() => router.push('/(tabs)/progress')}
   />
   ```

Cleanup:
- Remove masteryLevel from HeroCard props if present (legacy)
- Remove calculateLevel import from index.tsx if only used for masteryLevel

Styling considerations:
- TierSection should have slight top margin to separate from mascot (Spacing.sm)
- TierSection color scheme uses theme colors (primary for badge/bar)
  </action>
  <verify>
Run app and navigate to Home screen:
1. Tier badge (shield with number) visible below mascot
2. Tier name (e.g., "Student" for new user, or current tier) visible next to badge
3. Progress bar visible below tier name
4. Progress bar animates from empty to current progress on screen load
5. Tap tier section -> navigates to Progress tab
6. No TypeScript errors
7. No visual regression in existing HeroCard content
  </verify>
  <done>Home screen hero shows current tier with badge, name, animated progress bar, and tap-to-navigate</done>
</task>

</tasks>

<verification>
After all tasks complete:
1. `npx tsc --noEmit` - No TypeScript errors
2. Visual check: Home screen shows tier badge + name + progress bar below mascot
3. Animation check: Progress bar fills from empty on Home screen appear
4. Navigation check: Tapping tier section opens Progress tab
5. Edge cases: New user (Student, tier 1, progress 0), returning user with progress
</verification>

<success_criteria>
- [x] Home screen hero area shows current tier name (HERO-01 partial)
- [x] Progress bar shows progress to next tier (HERO-01 partial)
- [x] Tier badge (shield with number) visible alongside mascot (HERO-02)
- [x] Progress bar animates on appear
- [x] Tap-to-navigate works
</success_criteria>

<output>
After completion, create `.planning/phases/12-levels-on-hero/12-01-SUMMARY.md`
</output>
