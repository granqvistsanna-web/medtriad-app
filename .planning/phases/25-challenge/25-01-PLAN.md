---
phase: 25-challenge
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - medtriad/components/share/ShareCard.tsx
  - medtriad/app/quiz/results.tsx
  - medtriad/hooks/useShareCard.ts
autonomous: true

must_haves:
  truths:
    - "User sees 'Challenge a Friend' button on Results screen after quiz"
    - "Tapping button generates share card with competitive message"
    - "System share sheet opens for sharing via Messages, social apps, etc."
  artifacts:
    - path: "medtriad/components/share/ShareCard.tsx"
      provides: "Share card with competitive messaging"
      contains: "getChallengeMessage"
    - path: "medtriad/app/quiz/results.tsx"
      provides: "Challenge a Friend button"
      contains: "Challenge a Friend"
    - path: "medtriad/hooks/useShareCard.ts"
      provides: "Share hook with dialog title"
      contains: "dialogTitle"
  key_links:
    - from: "medtriad/app/quiz/results.tsx"
      to: "medtriad/components/share/ShareCard.tsx"
      via: "ShareCard component with competitive messaging"
      pattern: "ShareCard"
    - from: "medtriad/app/quiz/results.tsx"
      to: "medtriad/hooks/useShareCard.ts"
      via: "useShareCard hook for capture and share"
      pattern: "useShareCard"
---

<objective>
Add competitive "Challenge a Friend" feature to Results screen with score-based messaging.

Purpose: Enable social sharing with competitive edge to drive engagement and app discovery.
Output: Results screen with "Challenge a Friend" button that shares a visually styled card with competitive messaging.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/25-challenge/25-RESEARCH.md

# Existing implementation (modify these files)
@medtriad/components/share/ShareCard.tsx
@medtriad/hooks/useShareCard.ts
@medtriad/app/quiz/results.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add competitive messaging to ShareCard</name>
  <files>medtriad/components/share/ShareCard.tsx</files>
  <action>
Add a getChallengeMessage function that returns competitive text based on accuracy:
- 100%: "Beat my perfect score!"
- 90%+: "Think you can beat this?"
- 70%+: "Challenge accepted?"
- 50%+: "Can you do better?"
- Below 50%: "Let's see what you've got!"

Add a new prop `variant?: 'share' | 'challenge'` with default 'share' for backward compatibility.

When variant is 'challenge':
- Display the challenge message prominently below the headline
- Use brand.primary color for emphasis

Update the component:
1. Add variant prop to ShareCardProps type
2. Add getChallengeMessage function (similar pattern to existing getHeadline)
3. Render challenge message conditionally when variant='challenge'
4. Style challenge message with Text variant="body" and brand.primary color
5. Add marginBottom spacing between challenge message and mascot

Keep existing 'share' behavior unchanged for backward compatibility.
  </action>
  <verify>
TypeScript compiles without errors:
```bash
cd medtriad && npx tsc --noEmit
```
  </verify>
  <done>
ShareCard accepts variant prop and displays competitive message when variant='challenge'.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update Results screen and share hook for Challenge</name>
  <files>medtriad/app/quiz/results.tsx, medtriad/hooks/useShareCard.ts</files>
  <action>
Update useShareCard.ts:
1. Add optional dialogTitle parameter to share function signature
2. Pass dialogTitle to Sharing.shareAsync options (Android shows this in share dialog)
3. Default dialogTitle to undefined for backward compatibility

Update results.tsx:
1. Change button label from 'Share' to 'Challenge a Friend'
2. Update isSharing state label from 'Sharing...' to 'Challenging...'
3. Pass variant="challenge" to the ShareCard component in the offscreen capture area
4. Pass dialogTitle='Challenge a Friend' when calling share()

Implementation notes:
- The button is in the secondaryButtons row (line ~230-238)
- ShareCard is rendered in the offscreen View (line ~250-258)
- Keep share() call syntax simple: share('Challenge a Friend')
  </action>
  <verify>
1. TypeScript compiles:
```bash
cd medtriad && npx tsc --noEmit
```

2. App runs without errors:
```bash
cd medtriad && npx expo start
```
Navigate to quiz, complete it, verify Results screen shows "Challenge a Friend" button.
  </verify>
  <done>
Results screen shows "Challenge a Friend" button. Tapping it opens system share sheet with styled card containing competitive message.
  </done>
</task>

</tasks>

<verification>
1. Complete a quiz and reach Results screen
2. Verify button text shows "Challenge a Friend" (not "Share")
3. Tap the button
4. Verify share card appears in share sheet with:
   - Competitive message text (varies by score)
   - Score and correct count
   - MedTriads branding
5. Share to Messages or another app to confirm image quality
6. Test different score levels to verify message variations:
   - Perfect (10/10): "Beat my perfect score!"
   - High (9/10): "Think you can beat this?"
   - Medium (7/10): "Challenge accepted?"
   - Low (5/10): "Can you do better?"
</verification>

<success_criteria>
- [ ] Results screen shows "Challenge a Friend" button after completing quiz (CH-01)
- [ ] Tapping button generates share card with competitive message based on score (CH-02)
- [ ] System share sheet opens for sharing via Messages, social apps, etc. (CH-03)
- [ ] TypeScript compiles without errors
- [ ] Existing share functionality preserved for other use cases
</success_criteria>

<output>
After completion, create `.planning/phases/25-challenge/25-01-SUMMARY.md`
</output>
