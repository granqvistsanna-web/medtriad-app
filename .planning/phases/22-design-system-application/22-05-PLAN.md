---
phase: 22-design-system-application
plan: 05
type: execute
wave: 3
depends_on: ["22-02", "22-03"]
files_modified:
  - medtriad/constants/DESIGN-SYSTEM.md
  - medtriad/components/ui/Button.tsx
autonomous: true

must_haves:
  truths:
    - "DESIGN_SYSTEM.md documents all 7 primitives with API reference"
    - "DESIGN_SYSTEM.md includes migration examples"
    - "DESIGN_SYSTEM.md lists Solar Icon mappings"
    - "DESIGN_SYSTEM.md documents exceptions (category colors, confetti)"
    - "Legacy ui/Button.tsx is deleted or deprecated"
  artifacts:
    - path: "medtriad/constants/DESIGN-SYSTEM.md"
      provides: "Complete design system documentation"
      contains: "## Primitive Components"
      min_lines: 300
  key_links:
    - from: "medtriad/constants/DESIGN-SYSTEM.md"
      to: "primitives/"
      via: "component API documentation"
      pattern: "### Icon|### Text|### Surface|### Button|### Badge|### Tag|### Card"
---

<objective>
Create comprehensive DESIGN_SYSTEM.md documentation and clean up legacy components.

Purpose: Document the design system so future development follows established patterns. Remove legacy ui/Button.tsx to prevent confusion.

Output: Complete DESIGN_SYSTEM.md with token reference, primitive APIs, migration examples, and icon mappings. Legacy Button removed or deprecated.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-design-system-application/22-RESEARCH.md
@medtriad/constants/DESIGN-SYSTEM.md
@medtriad/components/primitives/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update DESIGN_SYSTEM.md with complete documentation</name>
  <files>medtriad/constants/DESIGN-SYSTEM.md</files>
  <action>
Rewrite DESIGN_SYSTEM.md to be the definitive reference for the design system. Structure:

```markdown
# MedTriads Design System

Complete reference for design tokens, primitive components, and usage patterns.

## Table of Contents
1. [Design Tokens](#design-tokens)
2. [Primitive Components](#primitive-components)
3. [Icon System](#icon-system)
4. [Migration Guide](#migration-guide)
5. [Documented Exceptions](#documented-exceptions)

---

## Design Tokens

### Colors

#### Semantic Theme Structure
```typescript
theme.colors.surface   // Background colors
theme.colors.text      // Text colors
theme.colors.brand     // Brand identity
theme.colors.success   // Success/correct states
theme.colors.warning   // Warning states
theme.colors.danger    // Error/danger states
theme.colors.border    // Border colors
theme.colors.gold      // Achievement colors
theme.colors.streak    // Streak/fire colors
theme.colors.blue      // Info/category colors
theme.colors.purple    // Purple accent
theme.colors.timer     // Timer state colors
theme.colors.icon      // Icon colors
```

[Include full color table with values]

### Typography
[Include typography variants table]

### Spacing
[Include spacing scale]

### Radius
[Include border radius scale]

### Shadows
[Include shadow definitions]

### Motion
[Include durations and spring presets]

---

## Primitive Components

### Icon
Purpose: Render Solar Icons with consistent sizing and colors.

```typescript
import { Icon } from '@/components/primitives';
import { Fire } from '@solar-icons/react-native/bold';

<Icon icon={Fire} size="md" color={theme.colors.brand.primary} />
```

**Props:**
| Prop | Type | Default | Description |
|------|------|---------|-------------|
| icon | ComponentType | required | Solar Icon component |
| size | 'sm' \| 'md' \| 'lg' | 'md' | Icon size (16/20/24) |
| color | string | theme.colors.icon.default | Icon color |

### Text
[Full API documentation]

### Surface
[Full API documentation]

### Button
[Full API documentation]

### Badge
[Full API documentation]

### Tag
[Full API documentation]

### Card
[Full API documentation]

---

## Icon System

### Solar Icons
We use @solar-icons/react-native for all icons. Import from Bold or Linear variants.

### SF Symbol to Solar Icon Mapping
| SF Symbol | Solar Icon | Import |
|-----------|------------|--------|
| house.fill | Home | @solar-icons/react-native/bold |
| house | Home2 | @solar-icons/react-native/linear |
| book.fill | Book | @solar-icons/react-native/bold |
| book | BookMinimalistic | @solar-icons/react-native/linear |
| chart.bar.fill | ChartSquare | @solar-icons/react-native/bold |
| gearshape.fill | Settings | @solar-icons/react-native/bold |
| flame.fill | Fire | @solar-icons/react-native/bold |
| star.fill | Star | @solar-icons/react-native/bold |
| trophy.fill | Cup | @solar-icons/react-native/bold |
| percent | PercentSquare | @solar-icons/react-native/bold |
| gamecontroller.fill | Gamepad | @solar-icons/react-native/bold |
| play.fill | Play | @solar-icons/react-native/bold |
| bolt.fill | Bolt | @solar-icons/react-native/bold |
| magnifyingglass | MagnifyingGlass | @solar-icons/react-native/bold |
| xmark | CloseCircle | @solar-icons/react-native/bold |
| chevron.right | AltArrowRight | @solar-icons/react-native/bold |
| square.and.arrow.up | Share | @solar-icons/react-native/bold |
| trash | TrashBin | @solar-icons/react-native/bold |

### Tab Bar Icons
Tab bar uses raw Solar Icons directly (not Icon primitive) because Expo Router passes color prop:
```typescript
tabBarIcon: ({ color, focused }) =>
  focused ? <Home size={28} color={color} /> : <Home2 size={28} color={color} />
```

---

## Migration Guide

### Before/After Examples

#### Text Migration
```typescript
// Before
import { Text } from 'react-native';
import { Typography, Colors } from '@/constants/theme';

<Text style={[styles.title, { color: colors.text }]}>Title</Text>

const styles = StyleSheet.create({
  title: { ...Typography.title },
});

// After
import { Text } from '@/components/primitives';

<Text variant="title">Title</Text>
```

#### Icon Migration
```typescript
// Before
import { IconSymbol } from '@/components/ui/icon-symbol';

<IconSymbol name="flame.fill" size={16} color={colors.primary} />

// After
import { Icon } from '@/components/primitives';
import { Fire } from '@solar-icons/react-native/bold';

<Icon icon={Fire} size="sm" color={theme.colors.brand.primary} />
```

#### Badge Migration
[Include example]

#### Card Migration
[Include example]

---

## Documented Exceptions

These intentional deviations from the design system are documented and acceptable:

### Category Colors (FilterChips.tsx)
10 unique color palettes for medical categories are kept for visual differentiation.
Located in: `components/library/FilterChips.tsx`

### Confetti Colors (TierUpCelebration.tsx)
Celebration-specific colors for confetti animation.
Located in: `components/quiz/TierUpCelebration.tsx`

---

## Common Mistakes

### DO NOT
- Import Text from 'react-native' (use primitives/Text)
- Use IconSymbol (use primitives/Icon with Solar Icons)
- Use Colors.light.* (use theme.colors.*)
- Use hardcoded color values (use theme tokens)
- Use Typography spread in StyleSheet (use Text variant prop)

### DO
- Import from '@/components/primitives'
- Use theme.colors for all color references
- Use Text variant prop for typography
- Use Icon primitive with Solar Icon components
- Document any exceptions with comments

---

*Last updated: Phase 22 - Design System Application*
```
  </action>
  <verify>
File exists and has comprehensive content:
```
wc -l medtriad/constants/DESIGN-SYSTEM.md
```
Should be 300+ lines.

Grep for key sections:
```
grep -c "## Primitive Components" medtriad/constants/DESIGN-SYSTEM.md
grep -c "### Icon" medtriad/constants/DESIGN-SYSTEM.md
grep -c "### Text" medtriad/constants/DESIGN-SYSTEM.md
grep -c "## Migration Guide" medtriad/constants/DESIGN-SYSTEM.md
grep -c "## Documented Exceptions" medtriad/constants/DESIGN-SYSTEM.md
```
  </verify>
  <done>
DESIGN_SYSTEM.md contains:
- Complete token reference (colors, typography, spacing, radius, shadows, motion)
- All 7 primitive component APIs (Icon, Text, Surface, Button, Badge, Tag, Card)
- SF Symbol to Solar Icon mapping table
- Migration examples (before/after)
- Documented exceptions (category colors, confetti)
- Common mistakes section
At least 300 lines of documentation
  </done>
</task>

<task type="auto">
  <name>Task 2: Clean up legacy ui/Button.tsx</name>
  <files>medtriad/components/ui/Button.tsx</files>
  <action>
Check if ui/Button.tsx is still imported anywhere:
```
grep -r "from '@/components/ui/Button'" medtriad/
grep -r "from '../ui/Button'" medtriad/
```

If NO imports found:
1. Delete the file: `rm medtriad/components/ui/Button.tsx`
2. Update any index.ts exports if applicable

If imports ARE found (shouldn't be after migration):
1. Update those files to use primitives/Button instead
2. Then delete ui/Button.tsx

Alternative approach (if unsure):
1. Add deprecation notice at top of ui/Button.tsx:
```typescript
/**
 * @deprecated Use primitives/Button instead.
 * This file will be removed in a future version.
 *
 * Migration:
 * - import { Button } from '@/components/primitives'
 * - Use icon prop with Solar Icon component
 */
```
2. Re-export primitives/Button for backward compatibility:
```typescript
export { Button } from '@/components/primitives';
```

Preference: Delete if no imports, deprecate if uncertain.
  </action>
  <verify>
If deleted:
```
ls medtriad/components/ui/Button.tsx 2>/dev/null && echo "Still exists" || echo "Deleted"
```
Should output "Deleted".

If deprecated:
```
head -10 medtriad/components/ui/Button.tsx
```
Should show deprecation notice.

TypeScript compiles:
```
cd medtriad && npx tsc --noEmit
```
  </verify>
  <done>
ui/Button.tsx either deleted or deprecated with re-export
No duplicate Button implementations causing confusion
All Button usage goes through primitives/Button
  </done>
</task>

<task type="auto">
  <name>Task 3: Final verification and cleanup</name>
  <files>
medtriad/components/ui/icon-symbol.tsx
  </files>
  <action>
Verify IconSymbol is no longer used in migrated files:
```
grep -r "IconSymbol" medtriad/app/ medtriad/components/ --include="*.tsx" | grep -v "icon-symbol.tsx"
```

If IconSymbol is still imported somewhere:
1. Those files were missed in migration
2. Update them to use Icon primitive with Solar Icons
3. Follow patterns from previous plans

Check that icon-symbol.tsx can be kept for any edge cases or deleted:
- If used anywhere -> keep it
- If not used -> consider deletion (but safe to keep for now)

Run final type check:
```
cd medtriad && npx tsc --noEmit
```

Run app and do a quick smoke test:
1. All 4 tabs work
2. Quiz flow works
3. Settings work
4. No visual regressions
  </action>
  <verify>
IconSymbol import count (should be 0 or 1 in icon-symbol.tsx only):
```
grep -r "IconSymbol" medtriad/app/ medtriad/components/ --include="*.tsx" | wc -l
```

TypeScript compiles:
```
cd medtriad && npx tsc --noEmit
```

App runs:
```
cd medtriad && npx expo start
```
  </verify>
  <done>
No IconSymbol imports outside of icon-symbol.tsx
TypeScript compiles without errors
App runs without errors
All screens render correctly
  </done>
</task>

</tasks>

<verification>
- [ ] DESIGN_SYSTEM.md has 300+ lines of documentation
- [ ] DESIGN_SYSTEM.md documents all 7 primitives
- [ ] DESIGN_SYSTEM.md includes icon mapping table
- [ ] DESIGN_SYSTEM.md includes migration examples
- [ ] DESIGN_SYSTEM.md documents exceptions
- [ ] ui/Button.tsx deleted or deprecated
- [ ] No IconSymbol imports in app code
- [ ] TypeScript compiles: `cd medtriad && npx tsc --noEmit`
</verification>

<success_criteria>
- DESIGN_SYSTEM.md is the definitive reference (300+ lines)
- All primitive APIs documented with props tables
- SF Symbol to Solar Icon mapping complete
- Migration examples show before/after patterns
- Documented exceptions list is accurate
- Legacy Button cleaned up
- No stray IconSymbol usage
- DS-12 requirement satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/22-design-system-application/22-05-SUMMARY.md`
</output>
