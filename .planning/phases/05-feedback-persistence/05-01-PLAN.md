---
phase: 05-feedback-persistence
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - medtriad/components/quiz/AnswerCard.tsx
  - medtriad/app/quiz/index.tsx
autonomous: true

must_haves:
  truths:
    - "Correct answer button shows green highlight with thick border immediately"
    - "Incorrect answer button shows red highlight with thick border"
    - "Correct answer is revealed with green highlight when user selects wrong answer"
    - "Non-selected, non-correct answers fade to 0.4 opacity during feedback"
    - "1.5 second pause occurs after answer before auto-advancing"
  artifacts:
    - path: "medtriad/components/quiz/AnswerCard.tsx"
      provides: "Visual feedback states including faded state"
      contains: "faded"
    - path: "medtriad/app/quiz/index.tsx"
      provides: "getAnswerState returning faded for non-selected answers"
      contains: "faded"
  key_links:
    - from: "medtriad/app/quiz/index.tsx"
      to: "medtriad/components/quiz/AnswerCard.tsx"
      via: "getAnswerState() returns state prop"
      pattern: "getAnswerState.*faded"
---

<objective>
Implement visual answer feedback with state-driven styling

Purpose: Users receive clear visual indication of correct/incorrect answers during the 1.5s feedback pause. Non-selected answers fade to focus attention on the result.

Output: AnswerCard supports 'faded' state, thicker borders on feedback, quiz screen returns faded state for non-selected answers.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/05-feedback-persistence/05-CONTEXT.md
@.planning/phases/05-feedback-persistence/05-RESEARCH.md
@medtriad/components/quiz/AnswerCard.tsx
@medtriad/app/quiz/index.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add faded state and thicker borders to AnswerCard</name>
  <files>medtriad/components/quiz/AnswerCard.tsx</files>
  <action>
    Extend AnswerCard to support visual feedback polish:

    1. Add 'faded' to AnswerState type:
       ```typescript
       type AnswerState = 'default' | 'correct' | 'incorrect' | 'revealed' | 'faded';
       ```

    2. Update getBorderWidth() function to return thicker borders for feedback states:
       ```typescript
       const getBorderWidth = () => {
         switch (state) {
           case 'correct':
           case 'incorrect':
           case 'revealed':
             return 3; // Thicker for visibility
           default:
             return 2;
         }
       };
       ```

    3. Update getBackgroundColor() to handle faded state (same as default):
       ```typescript
       case 'faded':
         return colors.backgroundCard;
       ```

    4. Update getBorderColor() to handle faded state (same as default):
       ```typescript
       case 'faded':
         return colors.border;
       ```

    5. Update getTextColor() to handle faded state (same as default):
       ```typescript
       case 'faded':
         return colors.text;
       ```

    6. Apply opacity in the style object:
       ```typescript
       opacity: state === 'faded' ? 0.4 : (disabled && state === 'default' ? 0.4 : 1),
       ```

    7. Use dynamic borderWidth in style object:
       ```typescript
       borderWidth: getBorderWidth(),
       ```

    8. Remove the static borderWidth from styles.card (it's now dynamic)
  </action>
  <verify>TypeScript compiles without errors: `cd medtriad && npx tsc --noEmit`</verify>
  <done>AnswerCard accepts 'faded' state, applies 0.4 opacity, and uses 3px border for feedback states</done>
</task>

<task type="auto">
  <name>Task 2: Update quiz screen to return faded state and use 1.5s delay</name>
  <files>medtriad/app/quiz/index.tsx</files>
  <action>
    Wire the faded state in getAnswerState and adjust delay:

    1. Update ANSWER_DELAY constant to exactly 1500ms:
       ```typescript
       const ANSWER_DELAY = 1500;
       ```

    2. Update getAnswerState return type to include 'faded':
       ```typescript
       const getAnswerState = (option: QuizOption): 'default' | 'correct' | 'incorrect' | 'revealed' | 'faded' => {
       ```

    3. Change the final return from 'default' to 'faded' for answered state:
       ```typescript
       if (status !== 'answered') return 'default';

       if (option.id === selectedOptionId) {
         return option.isCorrect ? 'correct' : 'incorrect';
       }
       if (option.isCorrect) {
         return 'revealed';
       }
       return 'faded'; // Non-selected, non-correct answers fade
       ```

    This ensures during the 1.5s feedback pause:
    - Selected correct answer: green highlight (correct)
    - Selected incorrect answer: red highlight (incorrect)
    - Actual correct answer: green highlight (revealed)
    - Other answers: faded to 0.4 opacity (faded)
  </action>
  <verify>
    Run the app: `cd medtriad && npx expo start`
    Play a quiz, answer a question:
    - Selected answer shows green (correct) or red (incorrect) with thick border
    - If wrong, correct answer shows green (revealed)
    - Other 2 answers are faded (0.4 opacity)
    - After 1.5 seconds, auto-advances to next question
  </verify>
  <done>Quiz displays faded state for non-selected answers during 1.5s feedback pause</done>
</task>

</tasks>

<verification>
- [ ] AnswerCard exports type includes 'faded'
- [ ] Feedback states (correct, incorrect, revealed) have 3px border
- [ ] Faded state applies 0.4 opacity
- [ ] getAnswerState returns 'faded' for non-selected, non-correct options when answered
- [ ] ANSWER_DELAY is 1500ms
- [ ] Visual feedback matches: green for correct, red for incorrect, fade for others
</verification>

<success_criteria>
1. Correct answer shows green highlight with thick border immediately
2. Incorrect answer shows red highlight and correct answer is revealed
3. Non-selected answers fade to 0.4 opacity during feedback
4. 1.5 second pause occurs after answer, then auto-advances
</success_criteria>

<output>
After completion, create `.planning/phases/05-feedback-persistence/05-01-SUMMARY.md`
</output>
